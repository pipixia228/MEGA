链接：
	Parper：[]()
	code：[]()https://hgao-cv.github.io/VADv2/
# 核心点
提出概率规划来应对规划的不确定性：以流式方式将多视图图像序列作为输入，将传感器数据转换为tocken([[UniAD-VAD-VAD_v2#1.5 tocken输入]])嵌入，输出动作的概率分布，并对一个动作进行采样来控制车辆
	1. 利用概率场函数来模拟从动作空间到概率分布的映射
	2. 将行动空间规划为大量规划词汇，并使用大量驾驶演示来学习基于规划词汇的规划行动的概率分布
VADv2从GPT中汲取灵感来应对不确定性问题。语言建模中也存在不确定性。在给定特定上下文的情况下，下一个单词是不确定的和概率的。 LLM 从大规模语料库中学习下一个单词的上下文条件概率分布，并从该分布中采样一个单词。受 LLM 的启发，VADv2 将规划政策建模为环境条件非平稳随机过程。 VADv2离散动作空间以生成规划词汇表，根据大规模驾驶演示近似概率分布，并在每个时间步从分布中采样一个动作来控制车辆。
# 框架
![[VADv2框架.png]]
**注：每个动作为一个路径点序列**
1. Scene Encoder（场景编码：picture—>scene tocken）
	1. map tocken：道路边界、车道线、交叉路口等
	2. agent tocken：周围车辆、行人等动态物体的状态（位置、速度、运动轨迹等）
	3. image tocken：直接从图像中提取的整体场景特征，包含上下文信息
	4. traffic element tocken:交通信号灯、停车标志等静态或动态信号信息
2. Probabilistic Planning（概率规划：连续行为空间—>离散为规划词汇—> planning tocken
	—>transformer解码为预测分布）
3. Training（训练）
	1. 分布损失：从大规模驾驶演示中学习概率分布。 KL 散度用于最小化预测分布与数据分布之间的差异
	2. 冲突损失：如果规划词汇中的一个动作与其他智能体的未来运动或道路边界相冲突，则该动作被视为负样本，则施加显著的损失权重以降低该动作的概率
	3. tocken损失：地图令牌、代理令牌和交通元素令牌受到相应监督信号的监督，以确保其显式编码相应的高级信息
4. Inference（推理）：每个时间步对概率最高的动作进行采样，并使用 PID 控制器将所选轨迹转换为控制信号（转向、油门和制动）